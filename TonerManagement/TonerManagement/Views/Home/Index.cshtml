@{
    ViewBag.Title = "Home Page";
}

@section styles{
    <link href="~/Content/Home.css" rel="stylesheet" type="text/css"/>
}

<body>

<div id="customerDropdown" class="ChartControlsHome"></div>

<div id="leftCalender" class="ChartControlsHome"></div>

<div id="rightCalender" class="ChartControlsHome"></div>

<div id="chartOptionsDropdownLeft" class="ChartControlsHome"></div>

<div id="chartOptionsDropdownRight" class="ChartControlsHome"></div>

<br/>
<div id="LeftHandChart" class="ChartInline"></div>
<div id="RightHandChart" class="ChartInline"></div>

<br/>
<div id="LowTonerGrid"></div>

</body>

@section scripts{
    <script type="text/javascript">
        $("document").ready(function() {
            var url = '@Url.Action("GetCustomersForUser","Customer")';
            var customerDropdown = $("#customerDropdown");
            var leftCalender = $("#leftCalender");
            var rightCalender = $("#rightCalender");
            var chartOptionsDropdownLeft = $("#chartOptionsDropdownLeft");
            var chartOptionsDropdownRight = $("#chartOptionsDropdownRight");
            var source = {
                datatype: 'json',
                datafields: [
                    { name: "customerId" },
                    { name: "customerName" },
                    { name: "customerAddress" },
                    { name: "customerContactNumber" },
                    { name: "Printers" },
                    { name: "StockLocations" },
                    { name: "UserCustomers" }
                ],
                url:url
            }
            var dataAdapterForCustomerDropdown = new $.jqx.dataAdapter(source);
            customerDropdown.jqxDropDownList({
                source: dataAdapterForCustomerDropdown,
                displayMember: "customerName",
                valueMember: "customerId",
                selectedIndex:0
            });

            leftCalender.jqxDateTimeInput({ formatString: "dd/MM/yyyy",selectionMode:"range" });
            rightCalender.jqxDateTimeInput({ formatString: "dd/MM/yyyy",selectionMode:"range" });
            var today = new Date();
            var monthAgo = new Date(today.getFullYear(), today.getMonth() - 1, today.getDate());
            var sixMonthAgo = new Date(today.getFullYear(), today.getMonth() - 6, today.getDate());
            leftCalender.jqxDateTimeInput('setRange', monthAgo, today);
            rightCalender.jqxDateTimeInput('setRange', sixMonthAgo, today);

            
            var sourceForChartType = [
                // Monthly
                { DisplayMember: "Cyan", ValueMember: "CyanMonthly", group: "Monthly" },
                { DisplayMember: "Yellow", ValueMember: "YellowMonthly", group: "Monthly" },
                { DisplayMember: "Magenta", ValueMember: "MagentaMonthly", group: "Monthly" },
                { DisplayMember: "Keying", ValueMember: "KeyingMonthly", group: "Monthly" },
                { DisplayMember: "Color", ValueMember: "ColorMonthly", group: "Monthly" },
                { DisplayMember: "All", ValueMember: "AllMonthly", group: "Monthly" },
                //Daily
                { DisplayMember: "Cyan", ValueMember: "CyanDaily", group: "Daily" },
                { DisplayMember: "Yellow", ValueMember: "YellowDaily", group: "Daily" },
                { DisplayMember: "Magenta", ValueMember: "MagentaDaily", group: "Daily" },
                { DisplayMember: "Keying", ValueMember: "KeyingDaily", group: "Daily" },
                { DisplayMember: "Color", ValueMember: "ColorDaily", group: "Daily" },
                { DisplayMember: "All", ValueMember: "AllDaily", group: "Daily" }
            ];
            chartOptionsDropdownLeft.jqxDropDownList({
                source: sourceForChartType,
                displayMember: "DisplayMember",
                valueMember: "ValueMember",
                selectedIndex: 11
            });
            chartOptionsDropdownLeft.jqxDropDownList({
                source: sourceForChartType,
                displayMember: "DisplayMember",
                valueMember: "ValueMember",
                selectedIndex: 5
            });
            var dataForLeftChart = {
                CustomerId: customerDropdown.jqxDropDownList('getSelectedItem').value,
                StartDate: leftCalender.jqxDateTimeInput('getRange').from,
                EndDate: leftCalender.jqxDateTimeInput('getRange').to,
                CoverageType: chartOptionsDropdownLeft.jqxDropDownList('getSelectedItem').value
            };
            var dataForRightChart = {
                CustomerId: customerDropdown.jqxDropDownList('getSelectedItem').value,
                StartDate: rightCalender.jqxDateTimeInput('getRange').from,
                EndDate: rightCalender.jqxDateTimeInput('getRange').to,
                CoverageType: chartOptionsDropdownRight.jqxDropDownList('getSelectedItem').value
            };
            var sourceLeftChart = {
                dataType: "json",
                dataFields: [
                    { name: 'Coverage' },
                    { name: 'Date' }
                ],
                url: '@Url.Action("GetCoverage","Home")',
                data: JSON.stringify(dataForLeftChart)
            };
            var sourceRightChart = {
                dataType: "json",
                dataFields: [
                    { name: 'Coverage' },
                    { name: 'Date' }
                ],
                url: '@Url.Action("GetCoverage","Home")',
                data: JSON.stringify(dataForRightChart)
            };

            var dataAdapterLeftChart = new $.jqx.dataAdapter(sourceLeftChart);
            var dataAdapterRightChart = new $.jqx.dataAdapter(sourceRightChart);
        })
    </script>
}